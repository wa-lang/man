<!DOCTYPE HTML>
<html lang="zh" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using https://github.com/wa-lang/wabook -->
        <meta charset="UTF-8">
        <title>Slice - Wa-lang's Manual</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../static/wabook/css/variables.css">
        <link rel="stylesheet" href="../static/wabook/css/general.css">
        <link rel="stylesheet" href="../static/wabook/css/chrome.css">
        <link rel="stylesheet" href="../static/wabook/css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../static/wabook/FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../static/wabook/fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../static/wabook/highlight.css">
        <link rel="stylesheet" href="../static/wabook/tomorrow-night.css">
        <link rel="stylesheet" href="../static/wabook/ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('wabook-theme');
                var sidebar = localStorage.getItem('wabook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('wabook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('wabook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('wabook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('wabook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter">
  <li class="chapter-item expanded ">
    <a href="../index.html" >Wa-lang's manual</a>
  </li>
  <li class="chapter-item expanded ">
    <a href="../preface.html" >Preface</a>
  </li>
  <li class="chapter-item expanded ">
    <a href="../1.InstallAndGetStart/readme.html" ><strong aria-hidden="true">1.</strong> Install And Get Start</a>
  </li>
  <ol class="section">
    <li class="chapter-item expanded ">
      <a href="../1.InstallAndGetStart/1.1.Install.html" ><strong aria-hidden="true">1.1.</strong> Install Wa-lang Compiler</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../1.InstallAndGetStart/1.2.HelloWorld.html" ><strong aria-hidden="true">1.2.</strong> hello world</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../1.InstallAndGetStart/1.3.Command.html" ><strong aria-hidden="true">1.3.</strong> wa command line</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../1.InstallAndGetStart/1.4.ProjectStructure.html" ><strong aria-hidden="true">1.4.</strong> Project directory structure</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../1.InstallAndGetStart/1.5.Plugins.html" ><strong aria-hidden="true">1.5.</strong> Plug-ins for IDE</a>
    </li>
  </ol>
  <li class="chapter-item expanded ">
    <a href="../2.ProgramStructure/readme.html" ><strong aria-hidden="true">2.</strong> Program structure</a>
  </li>
  <ol class="section">
    <li class="chapter-item expanded ">
      <a href="../2.ProgramStructure/2.1.GlobalDeclaration.html" ><strong aria-hidden="true">2.1.</strong> Global declaration</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../2.ProgramStructure/2.2.GlobalVariableDeclaration.html" ><strong aria-hidden="true">2.2.</strong> Global variable declaration</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../2.ProgramStructure/2.3.FunctionDeclaration.html" ><strong aria-hidden="true">2.3.</strong> Function declaration</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../2.ProgramStructure/2.4.ConstDeclaration.html" ><strong aria-hidden="true">2.4.</strong> Constant declaration</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../2.ProgramStructure/2.5.ImportDeclaration.html" ><strong aria-hidden="true">2.5.</strong> Import declaration</a>
    </li>
  </ol>
  <li class="chapter-item expanded ">
    <a href="../3.BasicTypes/readme.html" ><strong aria-hidden="true">3.</strong> Basic types</a>
  </li>
  <ol class="section">
    <li class="chapter-item expanded ">
      <a href="../3.BasicTypes/3.1.LocalVariableDeclaration.html" ><strong aria-hidden="true">3.1.</strong> Local variable declaration</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../3.BasicTypes/3.2.Integers.html" ><strong aria-hidden="true">3.2.</strong> Integers</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../3.BasicTypes/3.3.FloatingPointNumbers.html" ><strong aria-hidden="true">3.3.</strong> Floating point number</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../3.BasicTypes/3.4.String.html" ><strong aria-hidden="true">3.4.</strong> String</a>
    </li>
  </ol>
  <li class="chapter-item expanded ">
    <a href="../4.Function/readme.html" ><strong aria-hidden="true">4.</strong> Function</a>
  </li>
  <ol class="section">
    <li class="chapter-item expanded ">
      <a href="../4.Function/4.1.FunctionCall.html" ><strong aria-hidden="true">4.1.</strong> Function call</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../4.Function/4.2.FunctionValues.html" ><strong aria-hidden="true">4.2.</strong> Function values</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../4.Function/4.3.AnonymousFunctionsAndClosures.html" ><strong aria-hidden="true">4.3.</strong> Anonymous functions and closures</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../4.Function/4.4.ifStatements.html" ><strong aria-hidden="true">4.4.</strong> if statements</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../4.Function/4.5.forStatements.html" ><strong aria-hidden="true">4.5.</strong> for statements</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../4.Function/4.6.switchStatements.html" ><strong aria-hidden="true">4.6.</strong> switch statements</a>
    </li>
  </ol>
  <li class="chapter-item expanded ">
    <a href="../5.CompositeTypes/readme.html" ><strong aria-hidden="true">5.</strong> Composite types</a>
  </li>
  <ol class="section">
    <li class="chapter-item expanded ">
      <a href="../5.CompositeTypes/5.1.Reference.html" ><strong aria-hidden="true">5.1.</strong> Reference</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../5.CompositeTypes/5.2.Array.html" ><strong aria-hidden="true">5.2.</strong> Array</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../5.CompositeTypes/5.3.Slice.html" class="active"><strong aria-hidden="true">5.3.</strong> Slice</a>
    </li>
  </ol>
  <li class="chapter-item expanded ">
    <a href="../6.CustomTypes/readme.html" ><strong aria-hidden="true">6.</strong> Custom types</a>
  </li>
  <ol class="section">
    <li class="chapter-item expanded ">
      <a href="../6.CustomTypes/6.1.Structure.html" ><strong aria-hidden="true">6.1.</strong> Structure</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../6.CustomTypes/6.2.Method.html" ><strong aria-hidden="true">6.2.</strong> Method</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../6.CustomTypes/6.3.MethodValues.html" ><strong aria-hidden="true">6.3.</strong> Method values</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../6.CustomTypes/6.4.EmbeddedStructure.html" ><strong aria-hidden="true">6.4.</strong> Embedded structure</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../6.CustomTypes/6.5.AnonymousStructure.html" ><strong aria-hidden="true">6.5.</strong> Anonymous structure</a>
    </li>
  </ol>
  <li class="chapter-item expanded ">
    <a href="../7.Interface/readme.html" ><strong aria-hidden="true">7.</strong> Interface</a>
  </li>
  <ol class="section">
    <li class="chapter-item expanded ">
      <a href="../7.Interface/7.1.NullInterface.html" ><strong aria-hidden="true">7.1.</strong> Null interface - universal wrapper</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../7.Interface/7.2.Non-nullInterface.html" ><strong aria-hidden="true">7.2.</strong> Non-null interface</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../7.Interface/7.3.TypeAssertions.html" ><strong aria-hidden="true">7.3.</strong> Summary of type assertions</a>
    </li>
    <li class="chapter-item expanded ">
      <a href="../7.Interface/7.4.OtherFeatures.html" ><strong aria-hidden="true">7.4.</strong> Other features of interface</a>
    </li>
  </ol>
</ol>

            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                    </div>

                    <h1 class="menu-title"><a href="../index.html">Wa-lang's Manual</a></h1>

                    <div class="right-buttons">
                        <a href="https://github.com/wa-lang/man" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/wa-lang/man/edit/master/en/5.CompositeTypes/5.3.Slice.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <!-- Page table of contents -->
                    <div class="sidetoc"><nav class="pagetoc"></nav></div>

                    <main>
                        

                        <p><em>The content on this page is written in Chinese, and then traslated into English by machine. More accurate traslations are welcome at: <a href="https://github.com/wa-lang/man/tree/master/en">https://github.com/wa-lang/man/tree/master/en</a></em></p>
<p><em><strong>Ending's law: &quot;Any application that can be compiled to WebAssembly, will be compiled to WebAssembly eventually.&quot;</strong></em></p>
<h2>5.3. Slice</h2>
<p>The basic declaration of the slice type is as follows, <code>T</code> is the element type:</p>
<pre><code class="language-wa">[]T
</code></pre>
<p>The first impression of slices is very similar to arrays: they are both sequences of objects of a specific type, but there is a huge difference in their actual behavior. A slice is a partial reference to an array, which is often taken from an array, for example:</p>
<pre><code class="language-wa">    arr := [...]i32{1, 2, 3, 4}
    sl: []i32 = arr[0:2]
    println(len(sl))      // 2
    println(sl[0], sl[1]) // 1 2
</code></pre>
<p>The expression <code>arr[m:n]</code> returns a slice, starting from the <code>m</code> element of the array <code>arr</code>, with a slice length of <code>n-m</code>, similar to the syntax of a string. If <code>m</code> is omitted, It means starting from the first element of the array; if <code>n</code> is omitted, it means ending at the last element of the array. <code>m</code> and <code>n</code> must not exceed the actual range of the array, otherwise an exception will be triggered.</p>
<p>The actual data is not stored in the slice, the object accessed through <code>[]</code> is located in the array it refers to, which means that changing the object in the array may affect the slice and vice versa, for example:</p>
<pre><code class="language-wa">    arr := [...]i32{1, 2, 3, 4}
    sl := arr[0:2]
    println(sl[0]) // 1
    arr[0] = 13
    println(sl[0]) // 13
    sl[1] = 42
    println(arr[1]) // 42
</code></pre>
<p>The built-in function <code>cap</code> can be used to obtain the available capacity of a slice - the length of the array referenced by the slice minus the starting position of the slice, for example:</p>
<pre><code class="language-wa">    arr := [...]i32{11, 12, 13, 14}
    sl1 := arr[1:2]
    println(len(sl1), cap(sl1)) // 1 3
</code></pre>
<p>By definition, the capacity of a slice is always greater or equal to its length.</p>
<p>An array can be referenced by multiple slices. If there is overlap between the referenced parts, changes to the overlapping parts will also affect each other, for example:</p>
<pre><code class="language-wa">    arr := [...]i32{1, 2, 3, 4}
    sl1 := arr[0:2]
    sl2 := arr[1:3]
    println(sl2[0]) // 2
    sl1[1] = 42
    println(sl2[0]) // 42
</code></pre>
<p>In fact, using the <code>[m:n]</code> operator on a slice can also get a new slice, starting from the <code>m</code>th element of the source slice. The rest of the rules are similar to getting a slice from an array.</p>
<p>In addition to referencing arrays or existing slices, slices can also be created directly through the built-in function <code>make</code>. The general syntax is:</p>
<pre><code class="language-wa">make([]T, Len: int, Cap: int) =&gt; []T
make([]T, Len: int) =&gt; []T // Equivalent to make([]T, Len, Len)
</code></pre>
<p>The return value is a slice of type <code>[]T</code>, length <code>Len</code>, and capacity <code>Cap</code>, where <code>Cap</code> can be omitted, and the capacity of the slice is <code>Len</code>, for example:</p>
<pre><code class="language-wa">    sl1 := make([]i32, 3, 5)
    println(sl1[0], len(sl1), cap(sl1)) // 0 3 5
</code></pre>
<p>When using the <code>make</code> function to create a slice, an array of length <code>Cap</code> is implicitly created and referenced as the slice.</p>
<p>Another built-in function related to slicing is <code>append</code>, which is used to append elements to a slice. The general syntax is:</p>
<pre><code class="language-wa">append(sl []T, e T) =&gt; []T
</code></pre>
<p>This function appends element <code>e</code> to the end of slice <code>s</code> and returns a new slice. Since function calls in Wa-lang use value passing, the appending behavior will not affect the source slice <code>s</code>, so the actual commonly used writing method is as follows:</p>
<pre><code class="language-wa">    sl: []i32
    //...
    sl = append(sl, 42)
</code></pre>
<p>That is, assign the new slice returned by <code>append</code> to the source slice. <code>append</code> not only appends elements to a slice, but also appends another slice, for example:</p>
<pre><code class="language-wa">    sl1 := []i32{13, 42}
    sl2 := []i32{9527, 1024}
    sl1 = append(sl1, sl2...)
    println(sl1[0], sl1[1], sl1[2], sl1[3]) // 13 42 9527 1024
</code></pre>
<p>When the appended object is a slice, <code>...</code> should be added after the variable name.</p>
<p>Since the slice refers to an array with a fixed length, if the length of the slice does not exceed the available capacity of the array after appending an element using <code>append</code>, then the contents of the corresponding element of the array will be replaced by the appended element, for example:</p>
<pre><code class="language-wa">    arr := [...]i32{1, 2, 3}
    sl1 := arr[0:2]
    sl1 = append(sl1, 5)
    println(arr[2]) // 5    
</code></pre>
<p>If the length of the new slice exceeds the capacity of the original array, the <code>append</code> function will automatically re-apply for a large enough array, copy the elements of the source slice to the new array (a deep copy is automatically performed), and then perform the append. This situation is called slice expansion, for example:</p>
<pre><code class="language-wa">    arr := [...]i32{1, 2, 3}
    sl1 := arr[:]
    sl2 := append(sl1, 4)
    sl2[0] = 42
    println(sl1[0]) // 1
</code></pre>
<p>Obviously, if a slice expansion occurs, the mutual reference between the new slice and the source slice is severed.</p>
<p>Different from the data types introduced in the previous chapter, variables of the slice type are <strong>not comparable</strong> because slices are not pure value types, but have a reference relationship with the underlying array or even other slices, which makes the slice unable to guarantee that the element values ​​in it are unchanged.</p>
<p>Slices can only be compared with the constant <code>nil</code>, which is used to determine whether the slice has a value of 0, for example:</p>
<pre><code class="language-wa">    sl: []i32
    println(sl == nil, sl != nil) // true false
</code></pre>
<p>In fact, if you need to determine whether a slice is empty, you should not compare it with <code>nil</code>, but determine whether its length is 0, because there are slices with length 0 but not <code>nil</code>, for example:</p>
<pre><code class="language-wa">    arr := [...]i32{1, 2, 3}
    sl1 := arr[0:0]
    println(sl1 == nil, len(sl1), cap(sl1)) // false 0 3
</code></pre>
<p>Unless otherwise noted, Wa-lang programs should handle slices of length 0 in the same way as slices of <code>nil</code> values. The built-in function <code>append</code> meets this requirement. For example, the following program is legal:</p>
<pre><code class="language-wa">    sl: []i32 // sl == nil
    sl := append(sl, 5)
    println(sl[0]) // 5
</code></pre>
<hr>
<p>Known issues:</p>
<ul>
<li>Bounds checking is not performed when accessing slice elements. This problem does not affect syntax compatibility. Subsequent corrections to this problem will not affect the existing source code. Developers using Wa-lang do not need to deal with this issue specially.</li>
<li>No bounds checking was performed when using <code>[]</code> to get a new slice from an array or slice. This problem does not affect syntax compatibility. Subsequent corrections to this problem will not affect the existing source code. Developers using Wa-lang do not need to deal with this issue specially.</li>
</ul>


                        

                        

                        
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../5.CompositeTypes/5.2.Array.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                        
                            <!-- ../6.CustomTypes/readme.html -->
                            <a rel="next" href="../6.CustomTypes/readme.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../5.CompositeTypes/5.2.Array.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                
                    <a rel="next" href="../6.CustomTypes/readme.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../static/wabook/mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../static/wabook/clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../static/wabook/highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../static/wabook/book.js" type="text/javascript" charset="utf-8"></script>
        
        <script type="text/javascript" charset="utf-8">
            var pagePath = "5.CompositeTypes/5.3.Slice.md"
        </script>

        <!-- Custom JS scripts -->
        

    </body>
</html>
